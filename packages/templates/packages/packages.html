//{% extends "base.html" %}
{% load static %}

{% block post_CSS %}
<link rel="stylesheet" href="{% static 'packages/css/packages.css' %}">
{% endblock %}

{% block page_header %}
    <div class="container header-container">
        <div class="row">
            <div class="col"></div>
        </div>
    </div>
{% endblock %}

{% block content %}
<div class="jumbotron">
    <h1 class="display-3">Donations</h1>
    <p class="lead">Please Donate Â£10 towards local causes.</p>
    <a href="https://buy.stripe.com/test_bIY9En81D106gfKbIL" id="buy_now_btn" class="btn btn-primary">Buy Now</a>
  </div>

<div class="container h-100">
    <div class="row h-50">
        <div class="col-7 col-md-6 my-auto">
            
            <script>

                const buy_now_button = document.querySelector('#buy_now_btn')
        
                buy_now_button.addEventListener('click', event => {   
                    fetch('/checkout/')
                    .then((result) => { return result.json() })
                    .then((data) => {
                        var stripe = Stripe(data.stripe_public_key);
        
                        stripe.redirectToCheckout({
                        // Make the id field from the Checkout Session creation API response
                        // available to this file, so you can provide it as parameter here
                        // instead of the {{CHECKOUT_SESSION_ID}} placeholder.
                            sessionId: data.session_id
                        }).then(function (result) {
                        // If `redirectToCheckout` fails due to a browser or network
                        // error, display the localized error message to your customer
                        // using `result.error.message`.
                        });
                    }) 
                })
            </script>
            
        </div>
    </div>
</div>

    
    




{% endblock %}


{% block postloadjs %}
    {{ block.super }}
    
{% endblock %}
